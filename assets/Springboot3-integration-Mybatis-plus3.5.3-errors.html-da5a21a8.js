import{_ as t}from"./plugin-vue_export-helper-c27b6911.js";import{r as e,o,c as p,a,b as n,d as i,e as l}from"./app-8d307529.js";const c={},r=a("h1",{id:"springboot3整合mybatis-plus3-5-3报错",tabindex:"-1"},[a("a",{class:"header-anchor",href:"#springboot3整合mybatis-plus3-5-3报错","aria-hidden":"true"},"#"),n(" Springboot3整合Mybatis-plus3.5.3报错")],-1),g=a("h2",{id:"_1-前言背景",tabindex:"-1"},[a("a",{class:"header-anchor",href:"#_1-前言背景","aria-hidden":"true"},"#"),n(" 1.前言背景")],-1),u={href:"https://cloud.tencent.com/solution/database?from_column=20065&from=20065",target:"_blank",rel:"noopener noreferrer"},d=l(`<p>不过，在使用 SpringBoot3 整合 MyBatisplus 时出现了一些问题，花了不少时间处理。</p><h2 id="_2-开发环境" tabindex="-1"><a class="header-anchor" href="#_2-开发环境" aria-hidden="true">#</a> 2.开发环境</h2><p>因为这边想学习一下关于SprigBoot3的一些特性，我这里是从原来的SpringBoot2.3.6升级到了SpringBoot3.0。</p><p>使用的版本如下所示。</p><ul><li>Spring Boot 版本配置</li></ul><div class="language-xml line-numbers-mode" data-ext="xml"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>parent</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-boot-starter-parent<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>3.0.3<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>parent</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>MyBatis 版本配置</li></ul><div class="language-xml line-numbers-mode" data-ext="xml"><pre class="language-xml"><code><span class="token comment">&lt;!--mybatis-plus--&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>com.baomidou<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>mybatis-plus-boot-starter<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>3.5.3<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_3-问题出现" tabindex="-1"><a class="header-anchor" href="#_3-问题出现" aria-hidden="true">#</a> 3.问题出现</h2><p>当一切都配置完成之后，启动项目之后，直接报错，这里直接把报错相关的贴出来。</p><figure><img src="https://gaoziman.oss-cn-hangzhou.aliyuncs.com/Leo100/202311040016267.png" alt="image-20231104001612745" tabindex="0" loading="lazy"><figcaption>image-20231104001612745</figcaption></figure><p>当然，异常信息挺多，比如无法创建 Bean 的异常等等，不过上面的几个异常并不是问题主因。这里我直接定位到最后的异常上，异常信息是：</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token class-name">Property</span> &#39;sqlSessionFactory<span class="token char">&#39; or &#39;</span>sqlSessionTemplate&#39; are required
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>于是我们跟入代码发生异常的地方。</p><p>问题原因也很明显，sqlSessionTemplate 对象是空的，所以这边就直接报错了。</p><h2 id="_4-问题排查" tabindex="-1"><a class="header-anchor" href="#_4-问题排查" aria-hidden="true">#</a> 4.问题排查</h2><p>当然，由于把 SpringBoot 版本升级到 3 了，所以会觉得有很大的可能是版本升级导致了问题。</p><p>不过还是想自己查查问题，就依次检查了代码、数据库配置、MyBatisPlus 配置，都没有发现哪里写错了，接着就没头绪了。之后就通过源码Debug了一下，顺着启动流程走了一下，在<strong>SqlSessionFactoryBean</strong>这里发现了问题，<strong>NestedIOException</strong>这个类爆红了，正常情况下肯定是不会报错的。</p><figure><img src="https://gaoziman.oss-cn-hangzhou.aliyuncs.com/Leo100/202311040028768.png" alt="image-20231104002829604" tabindex="0" loading="lazy"><figcaption>image-20231104002829604</figcaption></figure><p>说明肯定是因为我们<strong>dataSource</strong>数据源的问题，于是我又重新检查了一下代码。最终在启动类发现了问题。</p><p>下面我贴出截图</p><figure><img src="https://gaoziman.oss-cn-hangzhou.aliyuncs.com/Leo100/202311040032157.png" alt="image-20231104003243998" tabindex="0" loading="lazy"><figcaption>image-20231104003243998</figcaption></figure><p>在SpringBoot应用程序启动类上加上(exclude = {DataSourceAutoConfiguration.class})会排除数据源的自动配置，这意味着我们需要手动配置数据源和事务管理器等依赖项。</p><p>如果使用MyBatis等持久层框架进行数据库操作，通常需要进行以下两个步骤：</p><ol><li>配置数据源：在配置文件中设置数据库连接信息，例如连接URL、用户名、密码等。</li><li>配置SqlSessionFactory和SqlSessionTemplate：这两个对象是MyBatis框架中用于操作数据库的核心组件。SqlSessionFactory用于创建SqlSession实例，SqlSessionTemplate是对SqlSession的一种封装，提供了更加简单易用的API接口。</li></ol><p><strong>如果SqlSessionTemplate对象为空，可能有以下几种原因：</strong></p><ol><li>没有正确配置数据源：如果我们没有正确配置数据源，SqlSessionFactory和SqlSessionTemplate就无法正常创建。需要确保配置文件中的数据库连接信息正确，并且已经将数据源和事务管理器纳入到Spring容器中。</li><li>没有正确配置SqlSessionFactory和SqlSessionTemplate：即使我们已经正确配置了数据源和事务管理器，但是如果没有正确配置SqlSessionFactory和SqlSessionTemplate，也会导致SqlSessionTemplate对象为空。需要检查一下SqlSessionFactory是否已经成功创建，并且使用了正确的MyBatis配置文件。</li><li>没有将SqlSessionTemplate纳入到Spring容器中：在Spring Boot应用程序中，我们需要将SqlSessionTemplate对象纳入到Spring容器中，这样才能在其他组件中自动注入SqlSessionTemplate对象。需要确保已经在配置文件中正确配置了MyBatis相关的Bean，并且使用了正确的注解或XML配置方式来将SqlSessionTemplate纳入到Spring容器中。</li></ol><p>需要注意的是，这里所说的原因并不全面，具体问题需要根据实际情况来进行排查分析。</p><p>我这里把这个注释掉之后，项目就正常启动了，大家可以参考一下。</p><h2 id="_5-总结" tabindex="-1"><a class="header-anchor" href="#_5-总结" aria-hidden="true">#</a> 5.总结</h2><p>以上便是本文的全部内容，本人才疏学浅，文章有什么错误的地方，欢迎大佬们批评指正！我是<strong>Leo</strong>，一个在互联网行业的小白，立志成为更好的自己。</p><p>如果你想了解更多关于<strong>Leo</strong>，可以关注公众号-程序员Leo，后面文章会首先同步至公众号。</p><figure><img src="https://gaoziman.oss-cn-hangzhou.aliyuncs.com/LeoPic202312031906036.png" alt="公众号封面" tabindex="0" loading="lazy"><figcaption>公众号封面</figcaption></figure>`,33);function m(k,S){const s=e("ExternalLinkIcon");return o(),p("div",null,[r,g,a("p",null,[n("大家好，我是Leo哥🫣🫣🫣，最近在学习SpringBoot3相关的的代码，开发过程中遇到了一些小坑，不过很快都解决了。然后就用 SpringBoot3 版本写了几个小 demo，比如 Web 开发、连接 "),a("a",u,[n("数据库"),i(s)]),n("、使用 JdbcTemplate 操作数据库，编码和测试都非常顺利，虽然是从 SpringBoot 2.x 版本升级到SpringBoot3，但是没有感觉到太多差别。")]),d])}const v=t(c,[["render",m],["__file","Springboot3-integration-Mybatis-plus3.5.3-errors.html.vue"]]);export{v as default};
